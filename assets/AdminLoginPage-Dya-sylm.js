import{c as P,j as e,C as U,a as D,b as M,d as L,A as j,e as y,f as v,U as F,I as N,E as q,g as B,B as x,H,s as h}from"./main-H-0Bnh9n.js";import{r,d as O}from"./react-vendor-jk5iiwGh.js";import"./vendor-supabase-CwR_Riwm.js";/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=P("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),V=()=>{const[c,b]=r.useState(""),[o,S]=r.useState(""),[u,A]=r.useState(!1),[n,d]=r.useState(!1),[g,i]=r.useState(""),[l,p]=r.useState(!1),[f,m]=r.useState(""),w=O(),E=async t=>{t.preventDefault(),d(!0),i(""),m("");try{const{data:a,error:s}=await h.auth.signInWithPassword({email:c,password:o});if(s)throw s;if(!a.user)throw new Error("Authentication failed");const{data:k,error:I}=await h.from("admin_users").select("id").eq("id",a.user.id).single();if(I||!k)throw await h.auth.signOut(),new Error("Access denied. Your account does not have admin privileges.");w("/admin")}catch(a){const s=a instanceof Error?a.message:"An unexpected error occurred.";console.error("Sign in error:",s),i(s)}finally{d(!1)}},C=async t=>{t.preventDefault(),d(!0),i(""),m("");try{const{data:a,error:s}=await h.auth.signUp({email:c,password:o});if(s)throw s;if(!a.user)throw new Error("Sign up failed");m("Account created! Admin access must be granted separately."),p(!1)}catch(a){const s=a instanceof Error?a.message:"Failed to create account.";console.error("Sign up error:",s),i(s)}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Admin Portal"}),e.jsx("p",{className:"text-gray-500",children:"Shatam Care Foundation"})]}),e.jsxs(U,{className:"shadow-lg",children:[e.jsx(D,{children:e.jsx(M,{className:"text-center text-xl",children:l?"Create Admin Account":"Admin Sign In"})}),e.jsxs(L,{children:[g&&e.jsxs(j,{variant:"destructive",className:"mb-4",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(v,{children:g})]}),f&&e.jsxs(j,{variant:"default",className:"mb-4 bg-green-50 border-green-200 text-green-800",children:[e.jsx(y,{className:"h-4 w-4 text-green-600"}),e.jsx(v,{children:f})]}),e.jsxs("form",{onSubmit:l?C:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(N,{id:"email",type:"email",value:c,onChange:t=>b(t.target.value),placeholder:"Email Address",className:"pl-10",required:!0,disabled:n})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(N,{id:"password",type:u?"text":"password",value:o,onChange:t=>S(t.target.value),placeholder:"Password",className:"pl-10 pr-10",required:!0,disabled:n}),e.jsx("button",{type:"button",onClick:()=>A(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",disabled:n,children:u?e.jsx(q,{className:"h-5 w-5"}):e.jsx(B,{className:"h-5 w-5"})})]})]}),e.jsx(x,{type:"submit",disabled:n||!c||!o,className:"w-full",children:n?"Processing...":l?"Create Account":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(x,{type:"button",variant:"link",onClick:()=>{p(!l),i(""),m("")},className:"text-sm",disabled:n,children:l?"Already have an account? Sign In":"Don't have an account? Sign Up"})})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(x,{variant:"outline",onClick:()=>w("/"),children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Back to Main Website"]})})]})})};export{V as default};
